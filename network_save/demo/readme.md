# 项目文档

## 文件名
`test`  表示用程序模拟数据发送给服务器端,用于前期编写接收端和调试使用
`work`  表示使用真实的数据源板发送数据,arm作为接收端,用于实际工程使用

## 项目需求
`接收数据源板通过网口（协议为UDP）发送的所有数据，储存至存储板硬盘`    
    
### 具体描述
该数据存储板与数据源板、及其他设备或上位机均通过交换机连接于同一个本地网络中。
数据源板的传输协议为UDP,数据率最大不大于2MB/s,数据源板向储存板的8081、8082、8083三个端口发送数据,
因采用UDP传输,收包顺序可能为乱序,不需要整理包的顺序,可后期读出由上位机软件进行数据包顺序的整理。
存储板配置1路SATA硬盘和1路千兆网。
存储板通过千兆网接收来自数据源板的数据后,立即保存至SATA硬盘中。
待工作结束，可通过千兆网读出硬盘中的数据文件。

## 版本
`test` 和 `work`

## 功能描述
`test`:
客户端(send)netudpclient首先按照数据包协议进行数据生成。发送时,每发送一个包,都有0.5ms的暂停,此举一能模拟10hz的频率(0.1秒100个包),二找到了接收端丢包问题的一个原因。客户端每0.1s发送100个数据包,每个包大小为1044字节,记为一次tPing。
服务器端(receive)netudpserver负责接收数据,在与网络建立连接后,循环监听发送的数据包。为了彻底解决丢包问题，因此将udp的内存缓冲区设置到最大。由于arm芯片的位数为32,一个文件只能写入2GB的数据,因此接收端在接收20000次tPing后,重新新建一个文件,文件名采用当前时间。

`work`:
客户端(send)采用数据源板发送数据包,分别向8081、8082、8083三个端口发送数据包,8081对应LF(0.1秒发送31个包,32364字节),8082对应HF(0.1秒发送188个包,196272字节),8083端口格式未定。
接收端(receive)在test的版本基础上,采用多线程的方式接收数据,主线程负责控制接收时间,三个子线程分别对三个端口的数据进行接收和储存。